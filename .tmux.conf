# --- Shell config (Apple Silicon) ---
set -g default-terminal "screen-256color"
set -ag terminal-overrides ",screen-256color:RGB"
set -g default-shell /opt/homebrew/bin/zsh
set -g default-command "/opt/homebrew/bin/zsh -il"

# plugins
set -g @plugin 'thewtex/tmux-mem-cpu-load'

# Remap prefix to C-a
set -g prefix 'C-a'
unbind-key C-b
unbind-key C-a

# open windows in same directory
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# vi-like keybindings
set-window-option -g mode-keys vi

bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# mouse passthrough
set -g mouse on

unbind -T copy-mode MouseDragEnd1Pane
bind-key -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

# status bar config
# -------------------------------------------------
# Gruvbox Warm Status Bar
# -------------------------------------------------
set -g status on
set -g status-interval 2
set -g status-justify centre
set -g status-position bottom

# Base colors
set -g status-style "fg=#ebdbb2,bg=#3c3836"   # light fg on warm dark bg

# Left side: Username + Host
set -g status-left-length 40
set -g status-left "#[fg=#b8bb26,bg=#3c3836,bold] #S #[default]"

# Right side: CPU / Time / Date
set -g status-right-length 80
set -g status-right "#[fg=#fabd2f]#(tmux-mem-cpu-load -a 2) #[fg=#d79921]| #[fg=#83a598]%H:%M #[fg=#d79921]| #[fg=#b8bb26]%Y-%m-%d "

# Window list
set-window-option -g window-status-format " #[fg=#ebdbb2]#I:#W "
set-window-option -g window-status-current-format " #[bg=#504945,fg=#fabd2f,bold]#I:#W#[default] "

# Pane border color
set-option -g pane-border-style "fg=#665c54"
set-option -g pane-active-border-style "fg=#d79921"

# Message styling (prompts, search bar etc.)
set -g message-style "fg=#ebdbb2,bg=#504945"
set -g message-command-style "fg=#ebdbb2,bg=#504945"

# ============================================
# TMUX PLUGIN MANAGER
# ============================================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'sainnhe/tmux-fzf'

# Tmux resurrect settings
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-capture-pane-contents 'on'

# Tmux continuum settings
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Initialize TPM (keep at bottom)
run '~/.tmux/plugins/tpm/tpm'